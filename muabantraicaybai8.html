<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hoáº¡t Äá»™ng Giao Tiáº¿p: Äi Chá»£ Mua Hoa Quáº£</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Gray-100 background */
        }
        .role-card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
            margin-bottom: 2rem;
            padding: 1.5rem; /* 24px */
            border-left-width: 8px;
        }
        .buyer-card {
            border-left-color: #3b82f6; /* Blue-500 */
        }
        .seller-card {
            border-left-color: #16a34a; /* Green-600 */
        }
        .role-title {
            font-size: 1.75rem; /* 28px */
            font-weight: 700;
            margin-bottom: 1rem; /* 16px */
        }
        .buyer-title {
            color: #2563eb; /* Blue-600 */
        }
        .seller-title {
            color: #15803d; /* Green-700 */
        }
        .task-list, .price-list, .shopping-list {
            list-style-type: none;
            padding-left: 0;
        }
        .task-list li, .price-list li, .shopping-list li {
            background-color: #f9fafb; /* Gray-50 */
            padding: 0.75rem; /* 12px */
            border-radius: 6px;
            margin-bottom: 0.5rem; /* 8px */
            border: 1px solid #e5e7eb; /* Gray-200 */
        }
        .task-list li::before {
            content: 'ğŸ›’';
            margin-right: 0.5rem;
        }
        .price-list li strong, .shopping-list li strong {
            color: #4b5563; /* Gray-600 */
        }
        .suggestion {
            background-color: #fffbeb; /* Amber-50 */
            border: 1px dashed #f59e0b; /* Amber-500 */
            padding: 1rem; /* 16px */
            border-radius: 8px;
            margin-top: 1rem; /* 16px */
        }
        .suggestion p {
            margin-bottom: 0.5rem; /* 8px */
        }
        .chinese-text {
            font-style: italic;
            color: #57534e; /* Stone-600 */
        }
        .pinyin-text {
            font-size: 0.9em;
            color: #78716c; /* Stone-500 */
            display: none; /* áº¨n Pinyin theo máº·c Ä‘á»‹nh */
        }
        .pinyin-text.visible {
            display: inline; /* Hiá»‡n Pinyin khi cÃ³ class 'visible' */
        }
        h3 {
            font-size: 1.25rem; /* 20px */
            font-weight: 600;
            margin-top: 1.25rem; /* 20px */
            margin-bottom: 0.75rem; /* 12px */
            color: #374151; /* Gray-700 */
        }
        hr {
            margin-top: 2rem;
            margin-bottom: 2rem;
            border-top-width: 2px;
            border-color: #e5e7eb; /* Gray-200 */
        }
        .printable-area {
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }
        .toggle-pinyin-btn {
            background-color: #eab308; /* Yellow-500 */
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.2s;
            margin-bottom: 1rem;
            border: none;
        }
        .toggle-pinyin-btn:hover {
            background-color: #ca8a04; /* Yellow-600 */
        }
        @media print {
            body {
                background-color: white;
                font-size: 12pt;
            }
            .role-card {
                box-shadow: none;
                border: 1px solid #ccc;
                margin-bottom: 1.5rem;
                padding: 1rem;
                page-break-inside: avoid;
            }
            .no-print {
                display: none;
            }
            .printable-area {
                max-width: 100%;
            }
            .role-title {
                font-size: 1.5rem;
            }
            h3 {
                font-size: 1.1rem;
            }
            .toggle-pinyin-btn {
                display: none; /* KhÃ´ng in nÃºt báº­t/táº¯t pinyin */
            }
            .pinyin-text { /* LuÃ´n hiá»ƒn thá»‹ pinyin khi in, hoáº·c báº¡n cÃ³ thá»ƒ quyáº¿t Ä‘á»‹nh áº©n Ä‘i */
                display: inline !important; 
            }
        }
    </style>
</head>
<body class="p-4 sm:p-8">
    <div class="printable-area">
        <header class="text-center mb-8 no-print">
            <h1 class="text-3xl font-bold text-gray-700">ğŸ›’ Hoáº¡t Äá»™ng Giao Tiáº¿p: Äi Chá»£ Mua Hoa Quáº£ ğŸ“</h1>
            <p class="text-md text-gray-500">å»å¸‚åœºä¹°æ°´æœ <span class="pinyin-text">(qÃ¹ shÃ¬chÇng mÇi shuÇguÇ’)</span></p>
        </header>

        <div class="role-card buyer-card">
            <button class="toggle-pinyin-btn no-print" onclick="togglePinyin(this)">ğŸ‘ï¸ Hiá»‡n Pinyin</button>
            <h2 class="role-title buyer-title">PHIáº¾U A: NGÆ¯á»œI MUA <span class="chinese-text">(ä¹°ä¸œè¥¿çš„äºº)</span> <span class="pinyin-text">(mÇi dÅngxi de rÃ©n)</span> ğŸ§‘â€ğŸŒ¾</h2>
            
            <h3>ğŸ“ Nhiá»‡m vá»¥ cá»§a báº¡n:</h3>
            <p class="mb-3 text-gray-700">Báº¡n Ä‘áº¿n má»™t cá»­a hÃ ng hoa quáº£. HÃ£y há»i giÃ¡ vÃ  mua nhá»¯ng thá»© cÃ³ trong "Danh sÃ¡ch cáº§n mua" cá»§a báº¡n. Báº¡n chá»‰ cÃ³ <strong class="text-red-600">30 Ä‘á»“ng (ä¸‰åå—é’± <span class="pinyin-text">sÄnshÃ­ kuÃ i qiÃ¡n</span>)</strong>, hÃ£y cháº¯c cháº¯n báº¡n Ä‘á»§ tiá»n tráº£ nhÃ©!</p>

            <h3>ğŸ›ï¸ Danh sÃ¡ch cáº§n mua <span class="chinese-text">(è´­ç‰©å•</span> <span class="pinyin-text">gÃ²uwÃ¹ dÄn</span>):</h3>
            <ul id="shopping-list-buyer" class="shopping-list">
                </ul>
            <p class="mt-2 text-sm text-gray-600">VÃ  há»i giÃ¡ thÃªm má»™t loáº¡i quáº£ khÃ¡c mÃ  báº¡n thÃ­ch (vÃ­ dá»¥: <span class="chinese-text">è¥¿ç“œ</span> <span class="pinyin-text">xÄ«guÄ</span> hoáº·c <span class="chinese-text">è‘¡è„</span> <span class="pinyin-text">pÃºtao</span>).</p>

            <div class="suggestion mt-6">
                <h3 class="mt-0 text-amber-700">ğŸ’¡ Gá»£i Ã½ cho báº¡n:</h3>
                <p class="text-gray-700">Náº¿u tháº¥y Ä‘áº¯t, báº¡n cÃ³ thá»ƒ thá»­ máº·c cáº£ báº±ng cÃ¡ch nÃ³i:</p>
                <p class="chinese-text text-lg">å¤ªè´µäº†ï¼ä¾¿å®œä¸€ç‚¹å„¿å§ï¼</p>
                <p class="pinyin-text">(TÃ i guÃ¬ le! PiÃ¡nyi yÃ¬diÇnr ba! - Äáº¯t quÃ¡! Ráº» má»™t chÃºt Ä‘i!)</p>
                <p class="mt-3 text-gray-700">CÃ¡c máº«u cÃ¢u há»¯u Ã­ch khÃ¡c:</p>
                <ul class="list-disc pl-5 text-sm text-gray-600">
                    <li><span class="chinese-text">...ä¸€æ–¤å¤šå°‘é’±ï¼Ÿ</span> <span class="pinyin-text">(...yÃ¬ jÄ«n duÅshao qiÃ¡n?)</span> (... bao nhiÃªu tiá»n má»™t cÃ¢n?)</li>
                    <li><span class="chinese-text">ä¸€å…±å¤šå°‘é’±ï¼Ÿ</span> <span class="pinyin-text">(yÃ­gÃ²ng duÅshao qiÃ¡n?)</span> (Tá»•ng cá»™ng bao nhiÃªu tiá»n?)</li>
                    <li><span class="chinese-text">ç»™ä½ é’±ã€‚</span> <span class="pinyin-text">(gÄ›i nÇ qiÃ¡n.)</span> (Gá»­i báº¡n tiá»n.)</li>
                </ul>
            </div>
        </div>

        <hr class="no-print">

        <div class="role-card seller-card">
            <button class="toggle-pinyin-btn no-print" onclick="togglePinyin(this)">ğŸ‘ï¸ Hiá»‡n Pinyin</button>
            <h2 class="role-title seller-title">PHIáº¾U B: NGÆ¯á»œI BÃN <span class="chinese-text">(å–ä¸œè¥¿çš„äºº)</span> <span class="pinyin-text">(mÃ i dÅngxi de rÃ©n)</span> ğŸª</h2>

            <h3>ğŸ“ Nhiá»‡m vá»¥ cá»§a báº¡n:</h3>
            <p class="mb-3 text-gray-700">Báº¡n lÃ  chá»§ má»™t cá»­a hÃ ng hoa quáº£. HÃ£y tráº£ lá»i cÃ¢u há»i cá»§a khÃ¡ch hÃ ng vÃ  tÃ­nh tá»•ng sá»‘ tiá»n há» pháº£i tráº£.</p>

            <h3>ğŸ·ï¸ Báº£ng giÃ¡ cá»§a báº¡n <span class="chinese-text">(ä½ çš„ä»·æ ¼å•</span> <span class="pinyin-text">nÇ de jiÃ gÃ© dÄn</span>):</h3>
            <ul id="price-list-seller" class="price-list">
                </ul>

            <div class="suggestion mt-6">
                <h3 class="mt-0 text-amber-700">ğŸ’¡ Gá»£i Ã½ cho báº¡n:</h3>
                <p class="text-gray-700">Khi khÃ¡ch hÃ ng tráº£ tiá»n, hÃ£y dÃ¹ng cÃ¡c máº«u cÃ¢u sau:</p>
                <ul class="list-disc pl-5 text-sm text-gray-600">
                    <li><span class="chinese-text">ä¸€å…±...å—...æ¯›ã€‚</span> <span class="pinyin-text">(yÃ­gÃ²ng...kuÃ i...mÃ¡o.)</span> (Tá»•ng cá»™ng... Ä‘á»“ng... hÃ o.)</li>
                    <li><span class="chinese-text">æ”¶ä½ ...å—ã€‚</span> <span class="pinyin-text">(shÅu nÇ...kuÃ i.)</span> (Nháº­n cá»§a báº¡n... Ä‘á»“ng.)</li>
                    <li><span class="chinese-text">æ‰¾ä½ ...å—...æ¯›ã€‚</span> <span class="pinyin-text">(zhÇo nÇ...kuÃ i...mÃ¡o.)</span> (Thá»‘i láº¡i báº¡n... Ä‘á»“ng... hÃ o.)</li>
                </ul>
                 <p class="mt-3 text-gray-700">CÃ¡c máº«u cÃ¢u há»¯u Ã­ch khÃ¡c:</p>
                <ul class="list-disc pl-5 text-sm text-gray-600">
                     <li><span class="chinese-text">ä½ è¦å‡ æ–¤ï¼Ÿ</span> <span class="pinyin-text">(nÇ yÃ o jÇ jÄ«n?)</span> (Báº¡n muá»‘n máº¥y cÃ¢n?)</li>
                     <li><span class="chinese-text">è¿˜è¦åˆ«çš„å—ï¼Ÿ</span> <span class="pinyin-text">(hÃ¡i yÃ o biÃ© de ma?)</span> (CÃ²n cáº§n gÃ¬ khÃ¡c khÃ´ng?)</li>
                     <li><span class="chinese-text">å¥½çš„ã€‚/ è¡Œã€‚</span> <span class="pinyin-text">(hÇo de. / xÃ­ng.)</span> (ÄÆ°á»£c thÃ´i. / Ok.)</li>
                </ul>
            </div>
        </div>
        
        <div class="text-center mt-8 mb-4 no-print">
            <button onclick="window.print()" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition duration-150 ease-in-out">
                ğŸ–¨ï¸ In Phiáº¿u
            </button>
             <button onclick="generateNewCards()" class="bg-green-500 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition duration-150 ease-in-out ml-2">
                ğŸ”„ Táº¡o Phiáº¿u Má»›i
            </button>
        </div>
    </div>

    <script>
        const allFruits = [
            { name: "TÃ¡o", chinese: "è‹¹æœ", pinyin: "pÃ­ngguÇ’", basePriceMin: 2.5, basePriceMax: 6 },
            { name: "Cam", chinese: "æ©˜å­", pinyin: "jÃºzi", basePriceMin: 2, basePriceMax: 4.5 },
            { name: "Chuá»‘i", chinese: "é¦™è•‰", pinyin: "xiÄngjiÄo", basePriceMin: 3, basePriceMax: 5 },
            { name: "DÆ°a háº¥u", chinese: "è¥¿ç“œ", pinyin: "xÄ«guÄ", basePriceMin: 1.5, basePriceMax: 3 },
            { name: "Nho", chinese: "è‘¡è„", pinyin: "pÃºtao", basePriceMin: 6, basePriceMax: 12 },
            { name: "XoÃ i", chinese: "èŠ’æœ", pinyin: "mÃ¡ngguÇ’", basePriceMin: 5, basePriceMax: 10 },
            { name: "LÃª", chinese: "æ¢¨", pinyin: "lÃ­", basePriceMin: 3, basePriceMax: 5.5 },
            { name: "ÄÃ o", chinese: "æ¡ƒå­", pinyin: "tÃ¡ozi", basePriceMin: 4, basePriceMax: 8 },
            { name: "Váº£i", chinese: "è”æ", pinyin: "lÃ¬zhÄ«", basePriceMin: 7, basePriceMax: 15 },
            { name: "DÃ¢u tÃ¢y", chinese: "è‰è“", pinyin: "cÇomÃ©i", basePriceMin: 10, basePriceMax: 20 },
            { name: "Thanh long", chinese: "ç«é¾™æœ", pinyin: "huÇ’lÃ³ngguÇ’", basePriceMin: 4, basePriceMax: 7 },
            { name: "Dá»©a", chinese: "è è", pinyin: "bÅluÃ³", basePriceMin: 3, basePriceMax: 6 }
        ];

        const jinQuantities = [
            { amount: 1, chinese: "ä¸€æ–¤", pinyin: "yÃ¬ jÄ«n" },
            { amount: 1.5, chinese: "ä¸€æ–¤åŠ", pinyin: "yÃ¬ jÄ«n bÃ n" },
            { amount: 2, chinese: "ä¸¤æ–¤", pinyin: "liÇng jÄ«n" },
            { amount: 2.5, chinese: "ä¸¤æ–¤åŠ", pinyin: "liÇng jÄ«n bÃ n" },
            { amount: 3, chinese: "ä¸‰æ–¤", pinyin: "sÄn jÄ«n" }
        ];

        function getRandomElement(arr) {
            return arr[Math.floor(Math.random() * arr.length)];
        }

        function getRandomInt(min, max) { // Láº¥y sá»‘ nguyÃªn
            min = Math.ceil(min);
            max = Math.floor(max);
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        
        function getRandomPrice(minKuai, maxKuai) {
            const kuai = getRandomInt(Math.floor(minKuai), Math.floor(maxKuai -1)); // Äá»ƒ cÃ³ chá»— cho hÃ o
            const mao = getRandomInt(0, 9); // 0 Ä‘áº¿n 9 hÃ o
            let price = kuai;
            if (mao > 0) {
                price += mao / 10;
            }
             // Äáº£m báº£o giÃ¡ khÃ´ng tháº¥p hÆ¡n minKuai vÃ  khÃ´ng cao hÆ¡n maxKuai
            price = Math.max(minKuai, price);
            price = Math.min(maxKuai, price);

            let priceString = `${kuai}å—`;
            if (mao > 0) {
                priceString += `${mao}æ¯›`;
            }
            return { value: parseFloat(price.toFixed(1)), string: priceString, pinyin: `${kuaiToPinyin(kuai)} kuÃ i` + (mao > 0 ? ` ${maoToPinyin(mao)} mÃ¡o` : "") };
        }

        function kuaiToPinyin(num) {
            // ÄÆ¡n giáº£n hÃ³a, cÃ³ thá»ƒ má»Ÿ rá»™ng cho sá»‘ lá»›n hÆ¡n
            const pinyinMap = ["lÃ­ng", "yÄ«", "Ã¨r", "sÄn", "sÃ¬", "wÇ”", "liÃ¹", "qÄ«", "bÄ", "jiÇ”", "shÃ­"];
            if (num <=10) return pinyinMap[num];
            if (num < 20) return `shÃ­ ${pinyinMap[num%10] || ''}`.trim();
            // ThÃªm logic cho sá»‘ lá»›n hÆ¡n náº¿u cáº§n
            return String(num); // Fallback
        }
         function maoToPinyin(num) {
            const pinyinMap = ["lÃ­ng", "yÄ«", "Ã¨r", "sÄn", "sÃ¬", "wÇ”", "liÃ¹", "qÄ«", "bÄ", "jiÇ”"];
            return pinyinMap[num] || String(num);
        }


        function generateShoppingList() {
            const shoppingListContainer = document.getElementById('shopping-list-buyer');
            shoppingListContainer.innerHTML = ''; // XÃ³a danh sÃ¡ch cÅ©
            
            let numItemsToBuy = getRandomInt(2, 3); // Mua 2 hoáº·c 3 loáº¡i
            let selectedFruitsForShopping = [];
            let availableFruits = [...allFruits]; // Táº¡o báº£n sao Ä‘á»ƒ khÃ´ng lÃ m thay Ä‘á»•i máº£ng gá»‘c

            for (let i = 0; i < numItemsToBuy; i++) {
                if (availableFruits.length === 0) break;
                const fruitIndex = Math.floor(Math.random() * availableFruits.length);
                const fruit = availableFruits.splice(fruitIndex, 1)[0]; // Chá»n vÃ  xÃ³a khá»i danh sÃ¡ch táº¡m
                const quantity = getRandomElement(jinQuantities);
                selectedFruitsForShopping.push({ ...fruit, quantity });

                const listItem = document.createElement('li');
                listItem.innerHTML = `<strong>${fruit.name} (<span class="chinese-text">${fruit.chinese}</span> <span class="pinyin-text">${fruit.pinyin}</span>):</strong> ${quantity.amount} cÃ¢n <span class="chinese-text">(${quantity.chinese})</span> <span class="pinyin-text">(${quantity.pinyin})</span>`;
                shoppingListContainer.appendChild(listItem);
            }
            return selectedFruitsForShopping;
        }

        function generatePriceList(shoppingList) {
            const priceListContainer = document.getElementById('price-list-seller');
            priceListContainer.innerHTML = ''; // XÃ³a danh sÃ¡ch cÅ©

            let sellerFruits = [...shoppingList]; // Báº¯t Ä‘áº§u vá»›i nhá»¯ng gÃ¬ ngÆ°á»i mua muá»‘n
            let availableFruitsForSeller = allFruits.filter(f => !shoppingList.some(sf => sf.chinese === f.chinese));

            // ThÃªm 2-3 loáº¡i quáº£ khÃ¡c vÃ o danh sÃ¡ch cá»§a ngÆ°á»i bÃ¡n
            let numExtraFruits = getRandomInt(2, 3);
            for (let i = 0; i < numExtraFruits; i++) {
                if (availableFruitsForSeller.length === 0) break;
                const fruitIndex = Math.floor(Math.random() * availableFruitsForSeller.length);
                const extraFruit = availableFruitsForSeller.splice(fruitIndex, 1)[0];
                sellerFruits.push(extraFruit);
            }
            
            // Sáº¯p xáº¿p láº¡i cho Ä‘áº¹p máº¯t (tÃ¹y chá»n)
            sellerFruits.sort((a,b) => a.name.localeCompare(b.name));

            sellerFruits.forEach(fruit => {
                const price = getRandomPrice(fruit.basePriceMin, fruit.basePriceMax);
                const listItem = document.createElement('li');
                listItem.innerHTML = `<strong>${fruit.name} (<span class="chinese-text">${fruit.chinese}</span> <span class="pinyin-text">${fruit.pinyin}</span>):</strong> ${price.string}/cÃ¢n <span class="chinese-text">(${price.string.replace('å—', 'å—ä¸€æ–¤').replace(/(\d)æ¯›$/, '$1æ¯›ä¸€æ–¤')})</span> <span class="pinyin-text">(${price.pinyin} yÃ¬ jÄ«n)</span>`;
                priceListContainer.appendChild(listItem);
            });
        }
        
        function generateNewCards() {
            const shoppingList = generateShoppingList();
            generatePriceList(shoppingList);
            // Äáº£m báº£o Pinyin Ä‘Æ°á»£c áº©n khi táº¡o tháº» má»›i
            document.querySelectorAll('.pinyin-text').forEach(el => el.classList.remove('visible'));
            document.querySelectorAll('.toggle-pinyin-btn').forEach(btn => btn.textContent = 'ğŸ‘ï¸ Hiá»‡n Pinyin');
        }

        window.togglePinyin = function(buttonElement) {
            const card = buttonElement.closest('.role-card');
            const pinyinTexts = card.querySelectorAll('.pinyin-text');
            let isCurrentlyVisible = pinyinTexts.length > 0 && pinyinTexts[0].classList.contains('visible');

            pinyinTexts.forEach(el => {
                el.classList.toggle('visible');
            });

            if (isCurrentlyVisible) {
                buttonElement.textContent = 'ğŸ‘ï¸ Hiá»‡n Pinyin';
            } else {
                buttonElement.textContent = 'ğŸ™ˆ áº¨n Pinyin';
            }
        }
        
        // Khá»Ÿi táº¡o khi táº£i trang
        window.onload = generateNewCards;

    </script>
</body>
</html>
